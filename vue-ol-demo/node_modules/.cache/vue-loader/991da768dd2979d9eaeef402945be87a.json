{"remainingRequest":"/home/agou-ops/tmp/vue-ol-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/agou-ops/tmp/vue-ol-demo/src/components/Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/agou-ops/tmp/vue-ol-demo/src/components/Map.vue","mtime":1619667343741},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAib2wvb2wuY3NzIjsKaW1wb3J0IE1hcCBmcm9tICJvbC9NYXAiOwppbXBvcnQgVmlldyBmcm9tICJvbC9WaWV3IjsKaW1wb3J0IFRpbGVMYXllciBmcm9tICJvbC9sYXllci9UaWxlIjsKaW1wb3J0IFhZWiBmcm9tICJvbC9zb3VyY2UvWFlaIjsKaW1wb3J0IHsgZGVmYXVsdHMgYXMgZGVmYXVsdENvbnRyb2xzLCBPdmVydmlld01hcCB9IGZyb20gIm9sL2NvbnRyb2wiOwppbXBvcnQgeyB0cmFuc2Zvcm0gfSBmcm9tICJvbC9wcm9qIjsKCmltcG9ydCB7CiAgdmVjdG9yLAogIGFkZEludGVyYWN0aW9uLAogIGNsZWFyRHJhd09uTWFwCn0gZnJvbSAiLi4vc2hhcmVkL3Rvb2xzL21lYXN1cmUiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNYXAiLAogIHByb3BzOiB7fSwKICBkYXRhOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB7CiAgICAgIG1hcEhlaWdodDogNTAwLAogICAgICBtYXA6IG51bGwKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMubWFwSGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gNjA7CiAgICAvLyDliJ3lp4vljJbnu5jliLblt6XlhbcKICAgIHRoaXMuJG9uKCJpbml0RHJhdyIsIHR5cGUgPT4gewogICAgICBhZGRJbnRlcmFjdGlvbih0aGlzLm1hcCwgdHlwZSk7CiAgICB9KTsKICAgIHRoaXMuJG9uKCJjbGVhbiIsICgpID0+IHsKICAgICAgY2xlYXJEcmF3T25NYXAodGhpcy5tYXApOwogICAgfSk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbigpIHsKICAgIGNvbnN0IHNvdXJjZSA9IG5ldyBYWVooewogICAgICB1cmw6ICJodHRwczovL3thLWN9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nIgogICAgfSk7CiAgICBjb25zdCBvdmVydmlld01hcENvbnRyb2wgPSBuZXcgT3ZlcnZpZXdNYXAoewogICAgICBsYXllcnM6IFsKICAgICAgICBuZXcgVGlsZUxheWVyKHsKICAgICAgICAgIHNvdXJjZQogICAgICAgIH0pCiAgICAgIF0KICAgIH0pOwoKICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoewogICAgICB0YXJnZXQ6ICJtYXAiLAogICAgICBsYXllcnM6IFsKICAgICAgICBuZXcgVGlsZUxheWVyKHsKICAgICAgICAgIHNvdXJjZQogICAgICAgIH0pLAogICAgICAgIHZlY3RvcgogICAgICBdLAogICAgICBjb250cm9sczogZGVmYXVsdENvbnRyb2xzKCkuZXh0ZW5kKFtvdmVydmlld01hcENvbnRyb2xdKSwKICAgICAgdmlldzogbmV3IFZpZXcoewogICAgICAgIGNlbnRlcjogWzUwMDAwMCwgNjAwMDAwMF0sCiAgICAgICAgem9vbTogNwogICAgICB9KQogICAgfSk7CiAgICB3aW5kb3cubWFwID0gbWFwOwogICAgdGhpcy5tYXAgPSBtYXA7CiAgICAvLyDmoLnmja7pvKDmoIfkuovku7bojrflj5blvZPliY3nmoTnu4/nuqzluqYKICAgIG1hcC5vbigiY2xpY2siLCAkZXZlbnQgPT4gewogICAgICBjb25zdCBsb25sYXQgPSB0cmFuc2Zvcm0oJGV2ZW50LmNvb3JkaW5hdGUsICJFUFNHOjM4NTciLCAiRVBTRzo0MzI2Iik7CiAgICAgIC8vICAgY29uc29sZS5sb2cobG9ubGF0KTsKICAgICAgdGhpcy4kZW1pdCgKICAgICAgICAibWFwLWNsaWNrIiwKICAgICAgICBgJHtsb25sYXRbMF0udG9GaXhlZCg2KX0sJHtsb25sYXRbMV0udG9GaXhlZCg2KX1gCiAgICAgICk7CiAgICB9KTsKICB9Cn07Cg=="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div id=\"map\" :style=\"{ height: mapHeight + 'px' }\"></div>\n  </div>\n</template>\n\n<script>\nimport \"ol/ol.css\";\nimport Map from \"ol/Map\";\nimport View from \"ol/View\";\nimport TileLayer from \"ol/layer/Tile\";\nimport XYZ from \"ol/source/XYZ\";\nimport { defaults as defaultControls, OverviewMap } from \"ol/control\";\nimport { transform } from \"ol/proj\";\n\nimport {\n  vector,\n  addInteraction,\n  clearDrawOnMap\n} from \"../shared/tools/measure\";\n\nexport default {\n  name: \"Map\",\n  props: {},\n  data: function() {\n    return {\n      mapHeight: 500,\n      map: null\n    };\n  },\n  created: function() {\n    this.mapHeight = window.innerHeight - 60;\n    // 初始化绘制工具\n    this.$on(\"initDraw\", type => {\n      addInteraction(this.map, type);\n    });\n    this.$on(\"clean\", () => {\n      clearDrawOnMap(this.map);\n    });\n  },\n  mounted: function() {\n    const source = new XYZ({\n      url: \"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n    });\n    const overviewMapControl = new OverviewMap({\n      layers: [\n        new TileLayer({\n          source\n        })\n      ]\n    });\n\n    const map = new Map({\n      target: \"map\",\n      layers: [\n        new TileLayer({\n          source\n        }),\n        vector\n      ],\n      controls: defaultControls().extend([overviewMapControl]),\n      view: new View({\n        center: [500000, 6000000],\n        zoom: 7\n      })\n    });\n    window.map = map;\n    this.map = map;\n    // 根据鼠标事件获取当前的经纬度\n    map.on(\"click\", $event => {\n      const lonlat = transform($event.coordinate, \"EPSG:3857\", \"EPSG:4326\");\n      //   console.log(lonlat);\n      this.$emit(\n        \"map-click\",\n        `${lonlat[0].toFixed(6)},${lonlat[1].toFixed(6)}`\n      );\n    });\n  }\n};\n</script>\n\n<style scoped>\n#map {\n  width: 100%;\n  height: 500px;\n}\n</style>"]}]}