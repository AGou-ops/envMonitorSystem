{"remainingRequest":"/home/agou-ops/tmp/vue-ol-demo/node_modules/babel-loader/lib/index.js!/home/agou-ops/tmp/vue-ol-demo/node_modules/eslint-loader/index.js??ref--13-0!/home/agou-ops/tmp/vue-ol-demo/src/shared/tools/measure.js","dependencies":[{"path":"/home/agou-ops/tmp/vue-ol-demo/src/shared/tools/measure.js","mtime":1619667343741},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/agou-ops/tmp/vue-ol-demo/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IHsgTGluZVN0cmluZywgUG9seWdvbiB9IGZyb20gJ29sL2dlb20nOwppbXBvcnQgRHJhdyBmcm9tICdvbC9pbnRlcmFjdGlvbi9EcmF3JzsKaW1wb3J0IHsgVmVjdG9yIGFzIFZlY3RvckxheWVyIH0gZnJvbSAnb2wvbGF5ZXInOwppbXBvcnQgeyB1bkJ5S2V5IH0gZnJvbSAnb2wvT2JzZXJ2YWJsZSc7CmltcG9ydCBPdmVybGF5IGZyb20gJ29sL092ZXJsYXknOwppbXBvcnQgeyBWZWN0b3IgYXMgVmVjdG9yU291cmNlIH0gZnJvbSAnb2wvc291cmNlJzsKaW1wb3J0IHsgZ2V0QXJlYSwgZ2V0TGVuZ3RoIH0gZnJvbSAnb2wvc3BoZXJlJzsKaW1wb3J0IHsgQ2lyY2xlIGFzIENpcmNsZVN0eWxlLCBGaWxsLCBTdHJva2UsIFN0eWxlIH0gZnJvbSAnb2wvc3R5bGUnOwppbXBvcnQgeyBnZXRMYXllcnNCeUlkIH0gZnJvbSAnLi4vdXRpbHMnOwp2YXIgc291cmNlID0gbmV3IFZlY3RvclNvdXJjZSgpOwp2YXIgdmVjdG9yID0gbmV3IFZlY3RvckxheWVyKHsKICBzb3VyY2U6IHNvdXJjZSwKICBzdHlsZTogbmV3IFN0eWxlKHsKICAgIGZpbGw6IG5ldyBGaWxsKHsKICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMiknCiAgICB9KSwKICAgIHN0cm9rZTogbmV3IFN0cm9rZSh7CiAgICAgIGNvbG9yOiAnIzY1MzNmZicsCiAgICAgIHdpZHRoOiAyCiAgICB9KSwKICAgIGltYWdlOiBuZXcgQ2lyY2xlU3R5bGUoewogICAgICByYWRpdXM6IDcsCiAgICAgIGZpbGw6IG5ldyBGaWxsKHsKICAgICAgICBjb2xvcjogJyM2NTMzZmYnCiAgICAgIH0pCiAgICB9KQogIH0pCn0pOwovKioKICogQ3VycmVudGx5IGRyYXduIGZlYXR1cmUuCiAqIEB0eXBlIHtpbXBvcnQoIi4uL3NyYy9vbC9GZWF0dXJlLmpzIikuZGVmYXVsdH0KICovCgp2YXIgc2tldGNoOwovKioKICogVGhlIGhlbHAgdG9vbHRpcCBlbGVtZW50LgogKiBAdHlwZSB7SFRNTEVsZW1lbnR9CiAqLwoKdmFyIGhlbHBUb29sdGlwRWxlbWVudDsKLyoqCiAqIE92ZXJsYXkgdG8gc2hvdyB0aGUgaGVscCBtZXNzYWdlcy4KICogQHR5cGUge092ZXJsYXl9CiAqLwoKdmFyIGhlbHBUb29sdGlwOwovKioKICogVGhlIG1lYXN1cmUgdG9vbHRpcCBlbGVtZW50LgogKiBAdHlwZSB7SFRNTEVsZW1lbnR9CiAqLwoKdmFyIG1lYXN1cmVUb29sdGlwRWxlbWVudDsKLyoqCiAqIE92ZXJsYXkgdG8gc2hvdyB0aGUgbWVhc3VyZW1lbnQuCiAqIEB0eXBlIHtPdmVybGF5fQogKi8KCnZhciBtZWFzdXJlVG9vbHRpcDsKLyoqCiAqIE1lc3NhZ2UgdG8gc2hvdyB3aGVuIHRoZSB1c2VyIGlzIGRyYXdpbmcgYSBwb2x5Z29uLgogKiBAdHlwZSB7c3RyaW5nfQogKi8KCnZhciBjb250aW51ZVBvbHlnb25Nc2cgPSAnQ2xpY2sgdG8gY29udGludWUgZHJhd2luZyB0aGUgcG9seWdvbic7Ci8qKgogKiBNZXNzYWdlIHRvIHNob3cgd2hlbiB0aGUgdXNlciBpcyBkcmF3aW5nIGEgbGluZS4KICogQHR5cGUge3N0cmluZ30KICovCgp2YXIgY29udGludWVMaW5lTXNnID0gJ0NsaWNrIHRvIGNvbnRpbnVlIGRyYXdpbmcgdGhlIGxpbmUnOwovKioKICogSGFuZGxlIHBvaW50ZXIgbW92ZS4KICogQHBhcmFtIHtpbXBvcnQoIi4uL3NyYy9vbC9NYXBCcm93c2VyRXZlbnQiKS5kZWZhdWx0fSBldnQgVGhlIGV2ZW50LgogKi8KCnZhciBwb2ludGVyTW92ZUhhbmRsZXIgPSBmdW5jdGlvbiBwb2ludGVyTW92ZUhhbmRsZXIoZXZ0KSB7CiAgaWYgKGV2dC5kcmFnZ2luZykgewogICAgcmV0dXJuOwogIH0KICAvKiogQHR5cGUge3N0cmluZ30gKi8KCgogIHZhciBoZWxwTXNnID0gJ0NsaWNrIHRvIHN0YXJ0IGRyYXdpbmcnOwoKICBpZiAoc2tldGNoKSB7CiAgICB2YXIgZ2VvbSA9IHNrZXRjaC5nZXRHZW9tZXRyeSgpOwoKICAgIGlmIChnZW9tIGluc3RhbmNlb2YgUG9seWdvbikgewogICAgICBoZWxwTXNnID0gY29udGludWVQb2x5Z29uTXNnOwogICAgfSBlbHNlIGlmIChnZW9tIGluc3RhbmNlb2YgTGluZVN0cmluZykgewogICAgICBoZWxwTXNnID0gY29udGludWVMaW5lTXNnOwogICAgfQogIH0KCiAgaGVscFRvb2x0aXBFbGVtZW50LmlubmVySFRNTCA9IGhlbHBNc2c7CiAgaGVscFRvb2x0aXAuc2V0UG9zaXRpb24oZXZ0LmNvb3JkaW5hdGUpOwogIGhlbHBUb29sdGlwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKfTsKCnZhciBkcmF3OyAvLyBnbG9iYWwgc28gd2UgY2FuIHJlbW92ZSBpdCBsYXRlcgoKLyoqCiAqIEZvcm1hdCBsZW5ndGggb3V0cHV0LgogKiBAcGFyYW0ge0xpbmVTdHJpbmd9IGxpbmUgVGhlIGxpbmUuCiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGZvcm1hdHRlZCBsZW5ndGguCiAqLwoKdmFyIGZvcm1hdExlbmd0aCA9IGZ1bmN0aW9uIGZvcm1hdExlbmd0aChsaW5lKSB7CiAgdmFyIGxlbmd0aCA9IGdldExlbmd0aChsaW5lKTsKICB2YXIgb3V0cHV0OwoKICBpZiAobGVuZ3RoID4gMTAwKSB7CiAgICBvdXRwdXQgPSBNYXRoLnJvdW5kKGxlbmd0aCAvIDEwMDAgKiAxMDApIC8gMTAwICsgJyAnICsgJ2ttJzsKICB9IGVsc2UgewogICAgb3V0cHV0ID0gTWF0aC5yb3VuZChsZW5ndGggKiAxMDApIC8gMTAwICsgJyAnICsgJ20nOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfTsKLyoqCiAqIEZvcm1hdCBhcmVhIG91dHB1dC4KICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5Z29uIFRoZSBwb2x5Z29uLgogKiBAcmV0dXJuIHtzdHJpbmd9IEZvcm1hdHRlZCBhcmVhLgogKi8KCgp2YXIgZm9ybWF0QXJlYSA9IGZ1bmN0aW9uIGZvcm1hdEFyZWEocG9seWdvbikgewogIHZhciBhcmVhID0gZ2V0QXJlYShwb2x5Z29uKTsKICB2YXIgb3V0cHV0OwoKICBpZiAoYXJlYSA+IDEwMDAwKSB7CiAgICBvdXRwdXQgPSBNYXRoLnJvdW5kKGFyZWEgLyAxMDAwMDAwICogMTAwKSAvIDEwMCArICcgJyArICdrbTxzdXA+Mjwvc3VwPic7CiAgfSBlbHNlIHsKICAgIG91dHB1dCA9IE1hdGgucm91bmQoYXJlYSAqIDEwMCkgLyAxMDAgKyAnICcgKyAnbTxzdXA+Mjwvc3VwPic7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9OwoKZnVuY3Rpb24gbW91c2VvdXRIYW5kbGVyKCkgewogIGhlbHBUb29sdGlwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQovKioKICog5Yid5aeL5YyW57uY5Yi25bel5YW3CiAqIEBwYXJhbSB7TWFwfSBtYXAg5Zyw5Zu+5a6e5L6L5a+56LGhCiAqIEBwYXJhbSB7U3RyaW5nfSBtZWFzdXJlVHlwZSDnu5jliLbnsbvlnovvvIzpu5jorqTmipjnjrAgbGluZe+8jOmdouS4uiBhcmVhCiAqLwoKCmZ1bmN0aW9uIGFkZEludGVyYWN0aW9uKG1hcCkgewogIHZhciBtZWFzdXJlVHlwZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJ2xpbmUnOwoKICBpZiAoZHJhdykgewogICAgbWFwLnJlbW92ZUludGVyYWN0aW9uKGRyYXcpOwogIH0KCiAgbWFwLm9uKCdwb2ludGVybW92ZScsIHBvaW50ZXJNb3ZlSGFuZGxlcik7CiAgbWFwLmdldFZpZXdwb3J0KCkuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBtb3VzZW91dEhhbmRsZXIpOwogIHZhciB0eXBlID0gbWVhc3VyZVR5cGUgPT0gJ2FyZWEnID8gJ1BvbHlnb24nIDogJ0xpbmVTdHJpbmcnOwogIGRyYXcgPSBuZXcgRHJhdyh7CiAgICBzb3VyY2U6IHNvdXJjZSwKICAgIHR5cGU6IHR5cGUsCiAgICBzdHlsZTogbmV3IFN0eWxlKHsKICAgICAgZmlsbDogbmV3IEZpbGwoewogICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpJwogICAgICB9KSwKICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHsKICAgICAgICBjb2xvcjogJ3JnYmEoMCwgMCwgMCwgMC41KScsCiAgICAgICAgbGluZURhc2g6IFsxMCwgMTBdLAogICAgICAgIHdpZHRoOiAyCiAgICAgIH0pLAogICAgICBpbWFnZTogbmV3IENpcmNsZVN0eWxlKHsKICAgICAgICByYWRpdXM6IDUsCiAgICAgICAgc3Ryb2tlOiBuZXcgU3Ryb2tlKHsKICAgICAgICAgIGNvbG9yOiAncmdiYSgwLCAwLCAwLCAwLjcpJwogICAgICAgIH0pLAogICAgICAgIGZpbGw6IG5ldyBGaWxsKHsKICAgICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpJwogICAgICAgIH0pCiAgICAgIH0pCiAgICB9KQogIH0pOwogIG1hcC5hZGRJbnRlcmFjdGlvbihkcmF3KTsKICBjcmVhdGVNZWFzdXJlVG9vbHRpcChtYXApOwogIGNyZWF0ZUhlbHBUb29sdGlwKG1hcCk7CiAgdmFyIGxpc3RlbmVyOwogIGRyYXcub24oJ2RyYXdzdGFydCcsIGZ1bmN0aW9uIChldnQpIHsKICAgIC8vIHNldCBza2V0Y2gKICAgIHNrZXRjaCA9IGV2dC5mZWF0dXJlOwogICAgLyoqIEB0eXBlIHtpbXBvcnQoIi4uL3NyYy9vbC9jb29yZGluYXRlLmpzIikuQ29vcmRpbmF0ZXx1bmRlZmluZWR9ICovCgogICAgdmFyIHRvb2x0aXBDb29yZCA9IGV2dC5jb29yZGluYXRlOwogICAgbGlzdGVuZXIgPSBza2V0Y2guZ2V0R2VvbWV0cnkoKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKGV2dCkgewogICAgICB2YXIgZ2VvbSA9IGV2dC50YXJnZXQ7CiAgICAgIHZhciBvdXRwdXQ7CgogICAgICBpZiAoZ2VvbSBpbnN0YW5jZW9mIFBvbHlnb24pIHsKICAgICAgICBvdXRwdXQgPSBmb3JtYXRBcmVhKGdlb20pOwogICAgICAgIHRvb2x0aXBDb29yZCA9IGdlb20uZ2V0SW50ZXJpb3JQb2ludCgpLmdldENvb3JkaW5hdGVzKCk7CiAgICAgIH0gZWxzZSBpZiAoZ2VvbSBpbnN0YW5jZW9mIExpbmVTdHJpbmcpIHsKICAgICAgICBvdXRwdXQgPSBmb3JtYXRMZW5ndGgoZ2VvbSk7CiAgICAgICAgdG9vbHRpcENvb3JkID0gZ2VvbS5nZXRMYXN0Q29vcmRpbmF0ZSgpOwogICAgICB9CgogICAgICBtZWFzdXJlVG9vbHRpcEVsZW1lbnQuaW5uZXJIVE1MID0gb3V0cHV0OwogICAgICBtZWFzdXJlVG9vbHRpcC5zZXRQb3NpdGlvbih0b29sdGlwQ29vcmQpOwogICAgfSk7CiAgfSk7CiAgZHJhdy5vbignZHJhd2VuZCcsIGZ1bmN0aW9uICgpIHsKICAgIG1lYXN1cmVUb29sdGlwRWxlbWVudC5jbGFzc05hbWUgPSAnb2wtdG9vbHRpcCBvbC10b29sdGlwLXN0YXRpYyc7CiAgICBtZWFzdXJlVG9vbHRpcC5zZXRPZmZzZXQoWzAsIC03XSk7IC8vIHVuc2V0IHNrZXRjaAoKICAgIHNrZXRjaCA9IG51bGw7IC8vIHVuc2V0IHRvb2x0aXAgc28gdGhhdCBhIG5ldyBvbmUgY2FuIGJlIGNyZWF0ZWQKCiAgICBtZWFzdXJlVG9vbHRpcEVsZW1lbnQgPSBudWxsOwogICAgY3JlYXRlTWVhc3VyZVRvb2x0aXAobWFwKTsKICAgIHVuQnlLZXkobGlzdGVuZXIpOwogIH0pOwp9Ci8qKgogKiBDcmVhdGVzIGEgbmV3IGhlbHAgdG9vbHRpcAogKi8KCgpmdW5jdGlvbiBjcmVhdGVIZWxwVG9vbHRpcChtYXApIHsKICBpZiAoaGVscFRvb2x0aXBFbGVtZW50ICYmIGhlbHBUb29sdGlwRWxlbWVudC5wYXJlbnROb2RlKSB7CiAgICBoZWxwVG9vbHRpcEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChoZWxwVG9vbHRpcEVsZW1lbnQpOwogIH0KCiAgaGVscFRvb2x0aXBFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgaGVscFRvb2x0aXBFbGVtZW50LmNsYXNzTmFtZSA9ICdvbC10b29sdGlwIGhpZGRlbic7CiAgaGVscFRvb2x0aXAgPSBuZXcgT3ZlcmxheSh7CiAgICBlbGVtZW50OiBoZWxwVG9vbHRpcEVsZW1lbnQsCiAgICBvZmZzZXQ6IFsxNSwgMF0sCiAgICBwb3NpdGlvbmluZzogJ2NlbnRlci1sZWZ0JwogIH0pOwogIG1hcC5hZGRPdmVybGF5KGhlbHBUb29sdGlwKTsKfQovKioKICogQ3JlYXRlcyBhIG5ldyBtZWFzdXJlIHRvb2x0aXAKICovCgoKZnVuY3Rpb24gY3JlYXRlTWVhc3VyZVRvb2x0aXAobWFwKSB7CiAgaWYgKG1lYXN1cmVUb29sdGlwRWxlbWVudCAmJiBtZWFzdXJlVG9vbHRpcEVsZW1lbnQucGFyZW50Tm9kZSkgewogICAgbWVhc3VyZVRvb2x0aXBFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobWVhc3VyZVRvb2x0aXBFbGVtZW50KTsKICB9CgogIG1lYXN1cmVUb29sdGlwRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIG1lYXN1cmVUb29sdGlwRWxlbWVudC5jbGFzc05hbWUgPSAnb2wtdG9vbHRpcCBvbC10b29sdGlwLW1lYXN1cmUnOwogIG1lYXN1cmVUb29sdGlwID0gbmV3IE92ZXJsYXkoewogICAgZWxlbWVudDogbWVhc3VyZVRvb2x0aXBFbGVtZW50LAogICAgb2Zmc2V0OiBbMCwgLTE1XSwKICAgIHBvc2l0aW9uaW5nOiAnYm90dG9tLWNlbnRlcicKICB9KTsKICBtYXAuYWRkT3ZlcmxheShtZWFzdXJlVG9vbHRpcCk7Cn0KCmZ1bmN0aW9uIGNsZWFyRHJhd09uTWFwKG1hcCkgewogIHNvdXJjZS5jbGVhcigpOwoKICBpZiAoaGVscFRvb2x0aXBFbGVtZW50ICYmIGhlbHBUb29sdGlwRWxlbWVudC5wYXJlbnROb2RlKSB7CiAgICBoZWxwVG9vbHRpcEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChoZWxwVG9vbHRpcEVsZW1lbnQpOwogIH0KCiAgaWYgKG1lYXN1cmVUb29sdGlwRWxlbWVudCAmJiBtZWFzdXJlVG9vbHRpcEVsZW1lbnQucGFyZW50Tm9kZSkgewogICAgbWVhc3VyZVRvb2x0aXBFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobWVhc3VyZVRvb2x0aXBFbGVtZW50KTsKICB9CgogIG1hcC5yZW1vdmVJbnRlcmFjdGlvbihkcmF3KTsKICBtYXAucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBwb2ludGVyTW92ZUhhbmRsZXIpOwogIG1hcC5nZXRWaWV3cG9ydCgpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgbW91c2VvdXRIYW5kbGVyKTsKICB2YXIgb3ZlcmxheWVycyA9IG1hcC5nZXRPdmVybGF5cygpLmdldEFycmF5KCk7CiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICBvdmVybGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKG92bGF5KSB7CiAgICAgIG1hcC5yZW1vdmVPdmVybGF5KG92bGF5KTsKICAgIH0pOwogIH0pOwogIG1hcC5yZW1vdmVMYXllcihnZXRMYXllcnNCeUlkKCdsb2NhdGlvbl9tYXJrZXInKSk7Cn0KCmV4cG9ydCB7IGFkZEludGVyYWN0aW9uLCB2ZWN0b3IsIGNsZWFyRHJhd09uTWFwIH07"},{"version":3,"sources":["/home/agou-ops/tmp/vue-ol-demo/src/shared/tools/measure.js"],"names":["LineString","Polygon","Draw","Vector","VectorLayer","unByKey","Overlay","VectorSource","getArea","getLength","Circle","CircleStyle","Fill","Stroke","Style","getLayersById","source","vector","style","fill","color","stroke","width","image","radius","sketch","helpTooltipElement","helpTooltip","measureTooltipElement","measureTooltip","continuePolygonMsg","continueLineMsg","pointerMoveHandler","evt","dragging","helpMsg","geom","getGeometry","innerHTML","setPosition","coordinate","classList","remove","draw","formatLength","line","length","output","Math","round","formatArea","polygon","area","mouseoutHandler","add","addInteraction","map","measureType","removeInteraction","on","getViewport","addEventListener","type","lineDash","createMeasureTooltip","createHelpTooltip","listener","feature","tooltipCoord","target","getInteriorPoint","getCoordinates","getLastCoordinate","className","setOffset","parentNode","removeChild","document","createElement","element","offset","positioning","addOverlay","clearDrawOnMap","clear","removeEventListener","overlayers","getOverlays","getArray","setTimeout","forEach","ovlay","removeOverlay","removeLayer"],"mappings":"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","sourcesContent":["import { LineString, Polygon } from 'ol/geom';\nimport Draw from 'ol/interaction/Draw';\nimport { Vector as VectorLayer } from 'ol/layer';\nimport { unByKey } from 'ol/Observable';\nimport Overlay from 'ol/Overlay';\nimport { Vector as VectorSource } from 'ol/source';\nimport { getArea, getLength } from 'ol/sphere';\nimport { Circle as CircleStyle, Fill, Stroke, Style } from 'ol/style';\nimport { getLayersById } from '../utils';\n\nconst source = new VectorSource();\nconst vector = new VectorLayer({\n  source: source,\n  style: new Style({\n    fill: new Fill({\n      color: 'rgba(255, 255, 255, 0.2)',\n    }),\n    stroke: new Stroke({\n      color: '#6533ff',\n      width: 2,\n    }),\n    image: new CircleStyle({\n      radius: 7,\n      fill: new Fill({\n        color: '#6533ff',\n      }),\n    }),\n  }),\n});\n\n/**\n * Currently drawn feature.\n * @type {import(\"../src/ol/Feature.js\").default}\n */\nlet sketch;\n\n/**\n * The help tooltip element.\n * @type {HTMLElement}\n */\nlet helpTooltipElement;\n\n/**\n * Overlay to show the help messages.\n * @type {Overlay}\n */\nlet helpTooltip;\n\n/**\n * The measure tooltip element.\n * @type {HTMLElement}\n */\nlet measureTooltipElement;\n\n/**\n * Overlay to show the measurement.\n * @type {Overlay}\n */\nlet measureTooltip;\n\n/**\n * Message to show when the user is drawing a polygon.\n * @type {string}\n */\nconst continuePolygonMsg = 'Click to continue drawing the polygon';\n\n/**\n * Message to show when the user is drawing a line.\n * @type {string}\n */\nconst continueLineMsg = 'Click to continue drawing the line';\n\n/**\n * Handle pointer move.\n * @param {import(\"../src/ol/MapBrowserEvent\").default} evt The event.\n */\nconst pointerMoveHandler = function(evt) {\n  if (evt.dragging) {\n    return;\n  }\n  /** @type {string} */\n  let helpMsg = 'Click to start drawing';\n\n  if (sketch) {\n    const geom = sketch.getGeometry();\n    if (geom instanceof Polygon) {\n      helpMsg = continuePolygonMsg;\n    } else if (geom instanceof LineString) {\n      helpMsg = continueLineMsg;\n    }\n  }\n\n  helpTooltipElement.innerHTML = helpMsg;\n  helpTooltip.setPosition(evt.coordinate);\n\n  helpTooltipElement.classList.remove('hidden');\n};\n\nlet draw; // global so we can remove it later\n\n/**\n * Format length output.\n * @param {LineString} line The line.\n * @return {string} The formatted length.\n */\nconst formatLength = function(line) {\n  const length = getLength(line);\n  let output;\n  if (length > 100) {\n    output = Math.round((length / 1000) * 100) / 100 + ' ' + 'km';\n  } else {\n    output = Math.round(length * 100) / 100 + ' ' + 'm';\n  }\n  return output;\n};\n\n/**\n * Format area output.\n * @param {Polygon} polygon The polygon.\n * @return {string} Formatted area.\n */\nconst formatArea = function(polygon) {\n  const area = getArea(polygon);\n  let output;\n  if (area > 10000) {\n    output = Math.round((area / 1000000) * 100) / 100 + ' ' + 'km<sup>2</sup>';\n  } else {\n    output = Math.round(area * 100) / 100 + ' ' + 'm<sup>2</sup>';\n  }\n  return output;\n};\n\nfunction mouseoutHandler() {\n  helpTooltipElement.classList.add('hidden');\n}\n/**\n * 初始化绘制工具\n * @param {Map} map 地图实例对象\n * @param {String} measureType 绘制类型，默认折现 line，面为 area\n */\nfunction addInteraction(map, measureType = 'line') {\n  if (draw) {\n    map.removeInteraction(draw);\n  }\n  map.on('pointermove', pointerMoveHandler);\n\n  map.getViewport().addEventListener('mouseout', mouseoutHandler);\n\n  const type = measureType == 'area' ? 'Polygon' : 'LineString';\n  draw = new Draw({\n    source: source,\n    type: type,\n    style: new Style({\n      fill: new Fill({\n        color: 'rgba(255, 255, 255, 0.2)',\n      }),\n      stroke: new Stroke({\n        color: 'rgba(0, 0, 0, 0.5)',\n        lineDash: [10, 10],\n        width: 2,\n      }),\n      image: new CircleStyle({\n        radius: 5,\n        stroke: new Stroke({\n          color: 'rgba(0, 0, 0, 0.7)',\n        }),\n        fill: new Fill({\n          color: 'rgba(255, 255, 255, 0.2)',\n        }),\n      }),\n    }),\n  });\n  map.addInteraction(draw);\n\n  createMeasureTooltip(map);\n  createHelpTooltip(map);\n\n  let listener;\n  draw.on('drawstart', function(evt) {\n    // set sketch\n    sketch = evt.feature;\n\n    /** @type {import(\"../src/ol/coordinate.js\").Coordinate|undefined} */\n    let tooltipCoord = evt.coordinate;\n\n    listener = sketch.getGeometry().on('change', function(evt) {\n      const geom = evt.target;\n      let output;\n      if (geom instanceof Polygon) {\n        output = formatArea(geom);\n        tooltipCoord = geom.getInteriorPoint().getCoordinates();\n      } else if (geom instanceof LineString) {\n        output = formatLength(geom);\n        tooltipCoord = geom.getLastCoordinate();\n      }\n      measureTooltipElement.innerHTML = output;\n      measureTooltip.setPosition(tooltipCoord);\n    });\n  });\n\n  draw.on('drawend', function() {\n    measureTooltipElement.className = 'ol-tooltip ol-tooltip-static';\n    measureTooltip.setOffset([0, -7]);\n    // unset sketch\n    sketch = null;\n    // unset tooltip so that a new one can be created\n    measureTooltipElement = null;\n    createMeasureTooltip(map);\n    unByKey(listener);\n  });\n}\n\n/**\n * Creates a new help tooltip\n */\nfunction createHelpTooltip(map) {\n  if (helpTooltipElement && helpTooltipElement.parentNode) {\n    helpTooltipElement.parentNode.removeChild(helpTooltipElement);\n  }\n  helpTooltipElement = document.createElement('div');\n  helpTooltipElement.className = 'ol-tooltip hidden';\n  helpTooltip = new Overlay({\n    element: helpTooltipElement,\n    offset: [15, 0],\n    positioning: 'center-left',\n  });\n  map.addOverlay(helpTooltip);\n}\n\n/**\n * Creates a new measure tooltip\n */\nfunction createMeasureTooltip(map) {\n  if (measureTooltipElement && measureTooltipElement.parentNode) {\n    measureTooltipElement.parentNode.removeChild(measureTooltipElement);\n  }\n  measureTooltipElement = document.createElement('div');\n  measureTooltipElement.className = 'ol-tooltip ol-tooltip-measure';\n  measureTooltip = new Overlay({\n    element: measureTooltipElement,\n    offset: [0, -15],\n    positioning: 'bottom-center',\n  });\n  map.addOverlay(measureTooltip);\n}\n\nfunction clearDrawOnMap(map) {\n  source.clear();\n  if (helpTooltipElement && helpTooltipElement.parentNode) {\n    helpTooltipElement.parentNode.removeChild(helpTooltipElement);\n  }\n  if (measureTooltipElement && measureTooltipElement.parentNode) {\n    measureTooltipElement.parentNode.removeChild(measureTooltipElement);\n  }\n\n  map.removeInteraction(draw);\n  map.removeEventListener('pointermove', pointerMoveHandler);\n  map.getViewport().removeEventListener('mouseout', mouseoutHandler);\n  const overlayers = map.getOverlays().getArray();\n  setTimeout(() => {\n    overlayers.forEach((ovlay) => {\n      map.removeOverlay(ovlay);\n    });\n  });\n  map.removeLayer(getLayersById('location_marker'));\n}\n\nexport { addInteraction, vector, clearDrawOnMap };\n"]}]}